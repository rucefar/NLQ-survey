<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8"> <!-- é é¢ç·¨ç¢¼è¨­å®šç‚º UTF-8ï¼Œé¿å…ä¸­æ–‡äº‚ç¢¼ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- RWDï¼šè®“è¡Œå‹•è£ç½®ä»¥æ­£ç¢ºæ¯”ä¾‹é¡¯ç¤º -->
    <title>ğŸŒ¿Nurtiliteç”Ÿæ´»ç‡Ÿé¤Šå•å·</title> <!-- ç€è¦½å™¨åˆ†é æ¨™é¡Œ -->
    <style>
        body {
            font-family: Arial, sans-serif; /* é è¨­å­—é«” */
            margin: 0; /* ç§»é™¤é è¨­å¤–è· */
            padding: 0; /* ç§»é™¤é è¨­å…§è· */
            background: #ffffff; /* ç´”ç™½èƒŒæ™¯ */
            color: #333; /* æ–‡å­—é¡è‰² */
            min-height: 100vh; /* æœ€å°é«˜åº¦ä½”æ»¿è¦–çª—é«˜åº¦ */
        }
        h1, h2 {
            color: #2c3e50; /* æ¨™é¡Œæ–‡å­—é¡è‰² */
            margin-bottom: 10px; /* æ¨™é¡Œåº•éƒ¨é–“è· */
        }
        section {
            margin-bottom: 40px; /* å€å¡Šä¹‹é–“è·é›¢ */
            padding: 20px; /* å€å¡Šå…§è· */
            background: #e8f5e9; /* æ·ºç¶ åº•ï¼Œé†’ç›®å€å¡Š */
            border-radius: 8px; /* åœ“è§’ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* æ·¡é™°å½± */
        }
        label {
            display: block; /* æ¯å€‹æ¨™ç±¤ä¸€è¡Œ */
            margin-bottom: 8px; /* èˆ‡ä¸‹ä¸€é …ç›®çš„è·é›¢ */
        }
        input[type="text"],
        input[type="number"] {
            width: 100%; /* è¼¸å…¥æ¬„ä½ä½”æ»¿å®¹å™¨å¯¬åº¦ */
            padding: 8px; /* å…§è·ï¼šæå‡å¯é»æ“Šé¢ç© */
            margin-top: 4px; /* èˆ‡æ¨™ç±¤æ–‡å­—é–“è· */
            margin-bottom: 12px; /* èˆ‡ä¸‹ä¸€å…ƒç´ é–“è· */
            border: 1px solid #ccc; /* é‚Šæ¡† */
            border-radius: 4px; /* åœ“è§’ */
        }
        table {
            width: 100%; /* è¡¨æ ¼ä½”æ»¿å¯¬åº¦ */
            border-collapse: collapse; /* åˆä½µé‚Šæ¡† */
            margin-bottom: 20px; /* èˆ‡ä¸‹æ–¹å…ƒç´ é–“è· */
        }
        th, td {
            border: 1px solid #ddd; /* è¡¨æ ¼æ ¼ç·š */
            padding: 8px; /* å…§è·ï¼šæå‡å¯è®€æ€§ */
            text-align: left; /* æ–‡å­—é å·¦ */
        }
        th {
            background: #f0f0f0; /* è¡¨é ­åº•è‰² */
        }
        /* ç—‡ç‹€è¡¨æ ¼å®¹å™¨çš„è¡¨æ ¼æ¨£å¼ */
        .symptom-list table {
            width: 100%; /* ä½”æ»¿å¯¬åº¦ */
            border-collapse: collapse; /* åˆä½µé‚Šæ¡† */
        }
        .symptom-list td {
            border: 1px solid #ddd; /* ç—‡ç‹€è¡¨æ ¼æ ¼ç·š */
            padding: 4px; /* å…§è·è¼ƒå°ï¼Œå¢åŠ å¯†åº¦ */
            vertical-align: top; /* å¤šåˆ—æ–‡å­—æ™‚é ‚ç«¯å°é½Š */
        }
        /* ç—‡ç‹€è¡¨æ ¼å…§çš„æ ¸å–æ–¹å¡Šèˆ‡æ–‡å­—å°é½Š */
        .symptom-list input[type="checkbox"] {
            margin-right: 4px; /* æ ¸å–æ–¹å¡Šèˆ‡æ–‡å­—è·é›¢ */
        }
        .btn { /* å…¨ç«™æŒ‰éˆ•æ¨£å¼ */
            display: inline-block; /* è¡Œå…§å€å¡Šï¼Œèƒ½è¨­å®šå¯¬é«˜ */
            padding: 30px 20px; /* â†‘â†“30ã€â†â†’20ï¼šæ§åˆ¶æŒ‰éˆ•å°ºå¯¸ */
            background: #3498db; /* è—è‰²èƒŒæ™¯ */
            color: #fff; /* ç™½å­— */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 4px; /* åœ“è§’ */
            cursor: pointer; /* æ»‘é¼ æ‰‹å‹ */
            font-size: 24px; /* æ–‡å­—å¤§å° */
            margin: 10px 10px 0 0; /* å¤–è·ï¼ˆä¸Šå³ä¸‹å·¦ï¼‰ */
        }
        .btn:hover { 
            background: #2980b9; /* æ»‘éè®Šæ·±è—ï¼Œæé«˜äº’å‹•æ„Ÿ */
        }

        /* é¦–é æŠ¬é ­å€ï¼ˆä¸Šæ–¹æ¨™é¡Œç½®ä¸­ï¼‰ */
        .home-header {
            text-align: center; /* æ¨™é¡Œç½®ä¸­ */
            margin-top: 40px; /* èˆ‡é é¢é ‚ç«¯è·é›¢ */
            margin-bottom: 20px; /* èˆ‡ä¸‹æ–¹å®¹å™¨è·é›¢ */
        }
        .home-header img {
            display: block; /* è®“ margin: auto ç”Ÿæ•ˆ */
            margin: 0 auto 8px auto; /* åœ–ç¤ºç½®ä¸­ï¼Œä¸‹æ–¹ç•™ 8px é–“è· */
            width: 80px; /* åœ–ç¤ºå¯¬åº¦ */
            height: auto; /* é«˜åº¦ç­‰æ¯”ä¾‹ */
        }
        .home-header h1 {
            font-size: 2rem; /* æ¨™é¡Œå°ºå¯¸ */
            margin: 0; /* ç§»é™¤é è¨­å¤–è· */
            color: #2c3e50; /* èˆ‡ h1/h2 ä¸€è‡´çš„æ·±è—ç° */
        }

        .home-container { 
            background-image: url('vine_panel_complete.png'); /* ä½¿ç”¨å®Œæˆçš„è—¤è”“é‚Šæ¡† PNG åœ– */
            background-size: contain; /* è®“æ•´å€‹é‚Šæ¡†å®Œæ•´å‡ºç¾ï¼ˆç­‰æ¯”ç¸®æ”¾ï¼‰ */
            background-repeat: no-repeat; /* ä¸é‡è¤‡å¹³èˆ– */
            background-position: center; /* é‚Šæ¡†ç½®ä¸­ */
            background-color: transparent; /* é€æ˜èƒŒæ™¯ä¿ç•™ç™½åº• */
            max-width: 700px; /* æœ€å¤§å¯¬åº¦æ§åˆ¶ */
            width: 90%; /* RWDï¼šå¯¬åº¦ 90% */
            margin: 0 auto; /* å€å¡Šå·¦å³ç½®ä¸­ */
            padding: 80px; /* å…§è·ï¼šç¢ºä¿æŒ‰éˆ•ä¸è¦è²¼åˆ°é‚Šæ¡† */
            box-sizing: border-box; /* ä½¿ padding ç´å…¥å¯¬åº¦è¨ˆç®— */
            min-height: 450px; /* åŸºç¤é«˜åº¦ï¼ˆç¶­æŒå¤–æ¡†æ¯”ä¾‹ï¼‰ */
            display: flex; /* ä½¿ç”¨ Flex ä¾†ç½®ä¸­å…§å®¹ */
            justify-content: center;  /* æ°´å¹³ç½®ä¸­æŒ‰éˆ•ç¾¤ */
            align-items: center;      /* å‚ç›´ç½®ä¸­æŒ‰éˆ•ç¾¤ */
            height: 100%;             /* é«˜åº¦ä½”çˆ¶å±¤ï¼ˆé…åˆ min-heightï¼‰ */
        }
        .home-buttons {
            display: flex; /* è®“å…©é¡†æŒ‰éˆ•ä¸¦æ’ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            gap: 20px; /* å…©é¡†æŒ‰éˆ•çš„é–“è· */
        }

        /* ç®¡ç†é é¢çš„åˆªé™¤æŒ‰éˆ•æ¨£å¼ */
        .delete-btn {
            background: #e74c3c; /* ç´…è‰²åˆªé™¤éµ */
            color: #fff; /* ç™½å­— */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 4px; /* åœ“è§’ */
            padding: 5px 10px; /* å…§è· */
            cursor: pointer; /* æ‰‹å‹æ¸¸æ¨™ */
        }
        .delete-btn:hover {
            background: #c0392b; /* æ»‘éè®Šæ·±ç´… */
        }

        /* ç®¡ç†é é¢çš„æ–°å¢æŒ‰éˆ•ï¼ˆç›®å‰æœªä½¿ç”¨ï¼Œå¯ä¿ç•™æ“´å……ï¼‰ */
        .add-btn {
            display: inline-block; /* è¡Œå…§å€å¡Š */
            margin-bottom: 10px; /* ä¸‹æ–¹é–“è· */
            padding: 8px 16px; /* å…§è· */
            background: #27ae60; /* ç¶ è‰²èƒŒæ™¯ */
            color: #fff; /* ç™½å­— */
            border: none; /* ç„¡é‚Šæ¡† */
            border-radius: 4px; /* åœ“è§’ */
            cursor: pointer; /* æ‰‹å‹æ¸¸æ¨™ */
        }
        .add-btn:hover {
            background: #1e8449; /* æ»‘éè®Šæ·±ç¶  */
        }

        .result {
            margin-top: 10px; /* èˆ‡ä¸Šæ–¹å…§å®¹é–“è· */
            font-weight: bold; /* ç²—é«”é†’ç›® */
            color: #e67e22; /* æ©˜è‰²å­—é«” */
        }

        /* ç®¡ç†é æ¨™é¡Œç½®ä¸­ */
        #managePage h1 {
            text-align: center; /* ç½®ä¸­æ¨™é¡Œ */
        }

        /* è¡Œå‹•è£ç½®å¾®èª¿ï¼šé¿å…è—¤è”“æ¡†å…§è·éå¤§æ“ å£“æŒ‰éˆ• */
        @media (max-width: 480px) {
            .home-container { padding: 40px; } /* å°è¢å¹•ç¸®å°å…§è· */
            .btn { font-size: 20px; padding: 20px 16px; } /* æŒ‰éˆ•å­—ç´šèˆ‡å…§è·ç•¥ç¸® */
        }
    </style>
</head>
<body>
    <!-- é¦–é ä¸»ç•«é¢å®¹å™¨ï¼ˆé è¨­é¡¯ç¤ºï¼‰ -->
    <div id="homePage"> <!-- é¦–é å¤–å±¤ï¼šç”¨æ–¼åˆ‡æ›ä¸åŒé é¢å¯è¦‹æ€§ -->
        <div class="home-header"> <!-- é¦–é æ¨™é¡Œç½®ä¸­å€å¡Š -->
            <h1>ğŸŒ¿Nurtiliteç”Ÿæ´»ç‡Ÿé¤Šå•å·</h1> <!-- ç¶²ç«™ä¸»æ¨™é¡Œ -->
        </div>
        <!-- è—¤è”“é‚Šæ¡†å®¹å™¨ï¼Œå…§å«é¦–é å…©é¡†ä¸»æŒ‰éˆ• -->
        <div class="home-container"> <!-- å«èƒŒæ™¯è—¤è”“æ¡†ï¼Œä¸¦ç”¨ Flex ç½®ä¸­å…§éƒ¨æŒ‰éˆ• -->
            <div class="home-buttons"> <!-- æŒ‰éˆ•ç¾¤ï¼šæ°´å¹³ç½®ä¸­ã€è¨­å®šé–“è· -->
              <button id="btnQuestionnaire" class="btn">ç”Ÿæ´»ç‡Ÿé¤Šå•å·</button> <!-- é€²å…¥å•å·é æŒ‰éˆ• -->
              <button id="btnManage" class="btn">å•å·è³‡æ–™ç®¡ç†</button> <!-- é€²å…¥ç®¡ç†é æŒ‰éˆ• -->
            </div>
        </div>
    </div>

    <!-- å•å·é ï¼ˆé è¨­éš±è—ï¼‰ -->
    <div id="questionnairePage" style="display:none;"> <!-- å•å·é é¢å®¹å™¨ï¼Œé€é JS åˆ‡æ›é¡¯ç¤º -->
        <h1>ğŸŒ¿ ç”Ÿæ´»å‹æ…‹èˆ‡ç‡Ÿé¤Šå•å·</h1> <!-- å•å·é æ¨™é¡Œ -->
        <form id="questionnaire"> <!-- å•å·è¡¨å–®ï¼Œæäº¤æ™‚ç”± JS æ””æˆª -->
            <section> <!-- ä¸€ã€åŸºæœ¬è³‡æ–™ -->
                <h2>ä¸€ã€åŸºæœ¬è³‡æ–™</h2>
                <label>å§“å
                    <input type="text" name="name" required> <!-- ä½¿ç”¨è€…å§“åï¼ˆå¿…å¡«ï¼‰ -->
                </label>
                <label>æ€§åˆ¥
                    <select name="gender" required> <!-- æ€§åˆ¥ï¼ˆå¿…é¸ï¼‰ -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç”·">ç”·</option>
                        <option value="å¥³">å¥³</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </label>
                <label>å¹´é½¡
                    <input type="number" name="age" min="0"> <!-- å¹´é½¡ï¼ˆæ•¸å­—ï¼Œ>=0ï¼‰ -->
                </label>
                <label>æ˜Ÿåº§
                    <select name="zodiac"> <!-- æ˜Ÿåº§ï¼ˆé¸å¡«ï¼‰ -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç‰¡ç¾Šåº§">ç‰¡ç¾Šåº§</option>
                        <option value="é‡‘ç‰›åº§">é‡‘ç‰›åº§</option>
                        <option value="é›™å­åº§">é›™å­åº§</option>
                        <option value="å·¨èŸ¹åº§">å·¨èŸ¹åº§</option>
                        <option value="ç…å­åº§">ç…å­åº§</option>
                        <option value="è™•å¥³åº§">è™•å¥³åº§</option>
                        <option value="å¤©ç§¤åº§">å¤©ç§¤åº§</option>
                        <option value="å¤©è åº§">å¤©è åº§</option>
                        <option value="å°„æ‰‹åº§">å°„æ‰‹åº§</option>
                        <option value="é­”ç¾¯åº§">é­”ç¾¯åº§</option>
                        <option value="æ°´ç“¶åº§">æ°´ç“¶åº§</option>
                        <option value="é›™é­šåº§">é›™é­šåº§</option>
                    </select>
                </label>
                <label>è·æ¥­
                    <input type="text" name="occupation"> <!-- è·æ¥­ -->
                </label>
                <label>å­¸æ­·
                    <input type="text" name="education"> <!-- å­¸æ­· -->
                </label>
                <label>èº«é«˜ (cm)
                    <input type="number" name="height" min="0" step="0.1"> <!-- èº«é«˜å…¬åˆ†ï¼ˆå¯å°æ•¸ï¼‰ -->
                </label>
                <label>é«”é‡ (kg)
                    <input type="number" name="weight" min="0" step="0.1"> <!-- é«”é‡å…¬æ–¤ï¼ˆå¯å°æ•¸ï¼‰ -->
                </label>
                <label>BMI
                    <input type="number" name="bmi" step="0.1" readonly> <!-- è‡ªå‹•è¨ˆç®— BMIï¼ˆå”¯è®€ï¼‰ -->
                </label>
                <label>é›»è©±æˆ– LINE ID
                    <input type="text" name="contact"> <!-- è¯çµ¡æ–¹å¼ -->
                </label>
                <label>å°±å¯¢æ™‚é–“
                    <select name="sleep_time"> <!-- ç¡è¦ºæ™‚é–“é¸å–® -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="10:00~11:00">10:00~11:00</option>
                        <option value="11:00~12:00">11:00~12:00</option>
                        <option value="12:00~1:00">12:00~1:00</option>
                        <option value="1:00~">1:00~</option>
                        <option value="é€šå®µæœªç¨…">é€šå®µæœªç¨…</option> <!-- åŸæ–‡ç”¨å­—ä¿æŒ -->
                    </select>
                </label>
                <label>æ—©é¤æ™‚é–“
                    <select name="breakfast_time"> <!-- æ—©é¤æ™‚é–“é¸å–® -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="6:00~7:00">6:00~7:00</option>
                        <option value="7:00~8:00">7:00~8:00</option>
                        <option value="8:00~9:00">8:00~9:00</option>
                        <option value="9:00~">9:00~</option>
                        <option value="ç¶“å¸¸æ²’åƒæ—©é¤">ç¶“å¸¸æ²’åƒæ—©é¤</option>
                    </select>
                </label>
                <label>é£²æ°´ç¨®é¡
                    <select name="water_type" id="waterTypeSelect"> <!-- é£²æ°´ç¨®é¡ï¼ˆå‹•æ…‹é¡¯ç¤ºä¸‹æ–¹æ·¨æ°´å™¨æ¬„ä½ï¼‰ -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç™½é–‹æ°´">ç™½é–‹æ°´</option>
                        <option value="ç¤¦æ³‰æ°´">ç¤¦æ³‰æ°´</option>
                        <option value="é£²æ–™">é£²æ–™</option>
                        <option value="å®¶ç”¨æ·¨æ°´å™¨">å®¶ç”¨æ·¨æ°´å™¨</option>
                    </select>
                </label>
                <!-- ç•¶é¸ã€Œå®¶ç”¨æ·¨æ°´å™¨ã€æ™‚é¡¯ç¤º -->
                <div id="waterFilterInfo" style="display:none; margin-top: 8px;"> <!-- å‹•æ…‹é¡¯ç¤ºçš„è£œå……æ¬„ä½ -->
                    <label>æ·¨æ°´å™¨å“ç‰Œèˆ‡é¡å‹
                        <input type="text" name="water_filter_info"> <!-- ä½¿ç”¨è€…å¡«å¯«æ·¨æ°´å™¨è³‡è¨Š -->
                    </label>
                </div>
                <label>æ˜¯å¦æœç”¨ç‡Ÿé¤Šè£œå……å“
                    <select name="supplements"> <!-- è£œå……å“ä½¿ç”¨é »ç‡ -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="æ²’æœ‰">æ²’æœ‰</option>
                        <option value="å¶çˆ¾">å¶çˆ¾</option>
                        <option value="æ›¾ç¶“">æ›¾ç¶“</option>
                        <option value="ç¾åœ¨">ç¾åœ¨</option>
                    </select>
                </label>
                <label>é‹å‹•ç¿’æ…£
                    <select name="exercise"> <!-- é‹å‹•ç¿’æ…£ -->
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="æ²’æœ‰">æ²’æœ‰</option>
                        <option value="å¶çˆ¾">å¶çˆ¾</option>
                        <option value="è¦å¾‹">è¦å¾‹</option>
                    </select>
                </label>
                <label>æ…¢æ€§ç–¾ç—…
                    <input type="text" name="chronic"> <!-- ä½¿ç”¨è€…å¡«å¯«æ…¢æ€§ç—…å² -->
                </label>
            </section>

            <section> <!-- äºŒã€ç”Ÿæ´»å‹æ…‹è©•ä¼°ï¼ˆå‹¾é¸ï¼2åˆ†ï¼Œç¶“ç”±é¡åˆ¥æ¬„ä½é€£å‹•ï¼‰ -->
                <h2>äºŒã€ç”Ÿæ´»å‹æ…‹è©•ä¼° (æ¯é¡Œ 2 åˆ†)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>é¡Œè™Ÿ</th> <!-- é¡Œç›®åºè™Ÿ -->
                            <th>è˜‹æœ579 ç–¾ç—…ç‡Ÿé¤Šéˆæˆ‘</th> <!-- é¡Œç›®æ•˜è¿°ï¼ˆåŸæ–‡ä¿ç•™ï¼‰ -->
                            <th>A</th> <!-- é¡åˆ¥æŒ‡æ¨™ï¼ˆè‡ªå‹•é€£å‹•å‹¾é¸ï¼‰ -->
                            <th>B</th>
                            <th>C</th>
                            <th>D</th>
                            <th>E</th>
                            <th>CaMg</th>
                            <th>FE</th>
                            <th>çº–ç¶­</th>
                            <th>è›‹ç™½è³ª</th>
                            <th>å¾®é‡å…ƒç´ </th>
                            <th>æ˜¯å¦</th> <!-- ä½¿ç”¨è€…å¯¦éš›å‹¾é¸è™• -->
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-row="1">
                            <td>1</td>
                            <td>æˆ‘æ¯å¤©éƒ½æœƒåƒ2ç¢—</td> <!-- é¡Œç›®å…§å®¹ -->
                            <td><input type="checkbox" class="category" data-row="1" data-cat="A" disabled></td> <!-- é¡åˆ¥å‹¾é¸ï¼ˆç”±ä¸‹æ–¹æ˜¯å¦é€£å‹•ï¼‰ -->
                            <td><input type="checkbox" class="category" data-row="1" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life1" class="lifestyle-item life-checkbox" data-row="1"></td> <!-- ä½¿ç”¨è€…å‹¾é¸ -->
                        </tr>
                        <tr data-row="2">
                            <td>2</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è”¬èœåŠæ°´æœå°æ–¼5ä»½</td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life2" class="lifestyle-item life-checkbox" data-row="2"></td>
                        </tr>
                        <tr data-row="3">
                            <td>3</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è‚‰ã€é­šå°æ–¼1.5ä»½ï¼ˆå…¨ç©€æ ¹è–é¡å°æ–¼0.5ä»½ï¼‰</td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life3" class="lifestyle-item life-checkbox" data-row="3"></td>
                        </tr>
                        <tr data-row="4">
                            <td>4</td>
                            <td>æˆ‘æ¯å¤©å–çš„ä¹³è£½å“å°‘æ–¼1.5æ¯</td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life4" class="lifestyle-item life-checkbox" data-row="4"></td>
                        </tr>
                        <tr data-row="5">
                            <td>5</td>
                            <td>æˆ‘æ¯å¤©å–çš„è±†æ¼¿æˆ–èŒ¶è‡³å°‘2æ¯</td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life5" class="lifestyle-item life-checkbox" data-row="5"></td>
                        </tr>
                        <tr data-row="6">
                            <td>6</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è›‹ç™½è³ªé£Ÿç‰©å°æ–¼5ä»½ï¼ˆå¤§è±†è›‹ç™½å°‘æ–¼1ä»½ï¼‰</td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life6" class="lifestyle-item life-checkbox" data-row="6"></td>
                        </tr>
                        <tr data-row="7">
                            <td>7</td>
                            <td>æˆ‘å¸¸åƒåŠ å·¥é£Ÿå“</td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life7" class="lifestyle-item life-checkbox" data-row="7"></td>
                        </tr>
                        <tr data-row="8">
                            <td>8</td>
                            <td>æˆ‘æœ‰å¸è¸çš„ç¿’æ…£</td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life8" class="lifestyle-item life-checkbox" data-row="8"></td>
                        </tr>
                        <tr data-row="9">
                            <td>9</td>
                            <td>æˆ‘ç¶“å¸¸ç¯€é£Ÿä»¥æ¸›è¼•é«”é‡</td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life9" class="lifestyle-item life-checkbox" data-row="9"></td>
                        </tr>
                    </tbody>
                </table>
                <button type="button" class="btn" onclick="computeScore()">è¨ˆç®—ç”Ÿæ´»å‹æ…‹åˆ†æ•¸</button> <!-- é»æ“Šå¾Œè¨ˆåˆ† -->
                <div id="lifestyleResult" class="result"></div> <!-- é¡¯ç¤ºåˆ†æ•¸çµæœ -->
            </section>

            <!-- ç½®ä¸­å¼·åŒ–çš„å£è™Ÿå¥ -->
            <p style="margin: 20px 0; font-weight: bold; font-size: 1.5rem; color: #1e7ec8; text-align: center;">
                çµ¦å°ææ–™åšå°äº‹ï¼ŒåŠ ä¸Šè¶³å¤ çš„æ™‚é–“ï¼Œäººé«”æ˜¯æœ€å¥½çš„é†«ç”Ÿ
            </p>

            <section> <!-- ä¸‰ã€ç—‡ç‹€èˆ‡ç‡Ÿé¤Šå»ºè­° -->
                <h2>ä¸‰ã€ç—‡ç‹€èˆ‡ç‡Ÿé¤Šå»ºè­° (å‹¾é¸æ‚¨æœ‰çš„ç—‡ç‹€)</h2>
                <div class="symptom-list"> <!-- JS å‹•æ…‹æ’å…¥ç—‡ç‹€è¡¨æ ¼çš„ä½ç½® -->
                    <!-- Symptoms will be injected here by JS -->
                </div>
            </section>

            <button type="submit" class="btn">æäº¤è¡¨å–®</button> <!-- é€å‡ºå¾Œç”± JS å„²å­˜èˆ‡è¼¸å‡ºçµæœ -->
            <button type="button" class="btn" id="btnReturnHome">å›é¦–é </button> <!-- è¿”å›é¦–é  -->
        </form>
        <div id="formOutput" class="result"></div> <!-- é€å‡ºå¾Œåœ¨æ­¤é¡¯ç¤ºå½™æ•´ -->
    </div>

    <!-- ç®¡ç†é ï¼ˆé è¨­éš±è—ï¼‰ -->
    <div id="managePage" style="display:none;"> <!-- é¡¯ç¤ºå·²å„²å­˜çš„ä½¿ç”¨è€…æ¸…å–® -->
        <h1>å•å·è³‡æ–™ç®¡ç†</h1>
        <button id="btnManageReturnHome" class="btn">å›é¦–é </button> <!-- å¾ç®¡ç†é å›é¦–é  -->
        <table id="manageTable"></table> <!-- ç”± JS å‹•æ…‹ç”Ÿæˆæ¸…å–®èˆ‡åˆªé™¤éµ -->
    </div>

    <script>
        // ====== è³‡æ–™ï¼šç—‡ç‹€èˆ‡å°æ‡‰å»ºè­°ï¼ˆä¾ä½ çš„ä¿®è¨‚ï¼‰ ======
        const symptoms = [
            { name: 'åˆ·ç‰™æµè¡€', rec: 'C' }, /* ç—‡ç‹€ï¼šå°æ‡‰å»ºè­° C */
            { name: 'ç™¼ç‡’', rec: 'P.C.éˆ£.éµ' }, /* å¤šå€‹å»ºè­°ä»¥ . åˆ†éš” */
            { name: 'é’æ˜¥ç—˜', rec: 'A.B' },
            { name: 'çš®è†šé¬†å¼›', rec: 'P.C.æ°´' },
            { name: 'éª¨è³ªç–é¬†', rec: 'C.éˆ£' },
            { name: 'è„‚è‚ªè‚', rec: 'P.B.C.åµ.ç”˜è‰' },
            { name: 'å£è§’ç‚', rec: 'B' },
            { name: 'åé ­ç—›', rec: 'B.C.éˆ£.åµ' },
            { name: 'è‡‰éæ²¹', rec: 'A.B.åµ' },
            { name: 'çš®è†šéæ•ç™¼ç‚', rec: 'A.B.C.éˆ£' },
            { name: 'æŠ½ç­‹', rec: 'B.éˆ£' },
            { name: 'è‚¥èƒ–', rec: 'P.B.C.åµ.çº–' },
            { name: 'å¸¸æ‰“å—', rec: 'B.éˆ£' },
            { name: 'æ˜“è…¹ç€‰', rec: 'P.B.è’œ.èŒ' },
            { name: 'ç²‰åˆº', rec: 'A' },
            { name: 'é ­çš®å±‘', rec: 'A.B.æ©„æ¬–æ²¹' },
            { name: 'æ°´è…«', rec: 'P.B.éˆ£' },
            { name: 'éœè„ˆæ›²å¼µ', rec: 'P.C.E' },
            { name: 'å£ä¹¾èˆŒç‡¥', rec: 'A.B' },
            { name: 'å£“åŠ›ç†¬å¤œ', rec: 'P.B' },
            { name: 'é»‘æ–‘', rec: 'C.E.åµ' },
            { name: 'è½é«®åˆ†å‰ç¦¿é ­', rec: 'P.B.åµ' },
            { name: 'å°¿è·¯çµçŸ³', rec: 'A.B.C.éˆ£.æ°´' },
            { name: 'è²§è¡€', rec: 'P.B.E.éµ' },
            { name: 'å£è‡­', rec: 'B' },
            { name: 'å¸¸æ„Ÿå†’', rec: 'P.A.C.ç´«éŒèŠ±' },
            { name: 'çš®è†šç²—ç³™', rec: 'A.åµ.æ©„æ¬–æ²¹' },
            { name: 'å¤šå¤¢ç£¨ç‰™', rec: 'B.éˆ£.åµ' },
            { name: 'å°¿é…¸é«˜ï¼ˆç—›é¢¨ï¼‰', rec: 'P.B.C.æ°´' },
            { name: 'æ›´å¹´æœŸ', rec: 'E.éˆ£.ç”˜è‰' },
            { name: 'è„¹æ°£æ¶ˆåŒ–ä¸è‰¯', rec: 'A.B.éˆ£.èŒ.é…µç´ ' },
            { name: 'éæ•æ‰“å™´åš', rec: 'P.A.C.E' },
            { name: 'æ¿•ç–¹', rec: 'B.æ©„æ¬–æ²¹.é­šæ²¹' },
            { name: 'è‚Œè‚‰é—œç¯€é…¸ç—›', rec: 'B.E.éˆ£.æœˆè¦‹.é­š' },
            { name: 'æ”è­·è…ºè‚¥å¤§', rec: 'P.A.é‹æ£•æ«š' },
            { name: 'è†½çµçŸ³', rec: 'A.æ—©é¤.é…µç´ ' },
            { name: 'èƒƒå£ä¸å¥½', rec: 'P.B.æ´»' },
            { name: 'ä¾¿ç§˜', rec: 'B.éˆ£.æ°´.çº–.åµ' },
            { name: 'ç¶“æœŸä¸é †', rec: 'P.æœˆè¦‹' },
            { name: 'æ†‚é¬±æ²®å–ª', rec: 'B.éˆ£.é­š.åµ' },
            { name: 'è†€èƒ±ç„¡åŠ›é »å°¿', rec: 'P.B.E.èŒ' },
            { name: 'æŠ½è¸å–é…’ç¿’æ…£', rec: 'A.B.C.E' },
            { name: 'èƒƒç—›', rec: 'P' },
            { name: 'æ‰‹è…³å†°å†·', rec: 'P.E.åµ.æœˆè¦‹' },
            { name: 'ç¶“ç—›', rec: 'P.B.éˆ£.æœˆè¦‹' },
            { name: 'è¨˜æ†¶åŠ›æ¸›é€€', rec: 'P.éµ.åµ.è‚‰è“¯è“‰' },
            { name: 'è¡€ç³–åé«˜', rec: 'P.éµ.é‹æ£•æ«š' },
            { name: 'è€èŠ±çœ¼ç™½å…§éšœ', rec: 'B.C.E.è‘‰é»ƒç´ ' },
            { name: 'å¸¸åƒè—¥', rec: 'B.C' },
            { name: 'ä¸æ˜“å—å­•', rec: 'P.A.E.æœˆè¦‹.éµ.é‹…' },
            { name: 'å­•å', rec: 'B' },
            { name: 'å¤±çœ ç¡ä¸å¥½', rec: 'B.éˆ£.ç”˜è‰' },
            { name: 'è¡€å£“åé«˜', rec: 'B.éˆ£.Q10.é­š.èŒ¶' },
            { name: 'é£›èšŠç—‡', rec: 'A.C.è‘‰é»ƒç´ ' },
            { name: 'ç–²å€¦', rec: 'P.B' },
            { name: 'ç™½å¸¶', rec: 'A.B.è’œ.èŒ' },
            { name: 'æ‡·å­•å“ºä¹³', rec: 'P.ç¶œåˆ.B.éˆ£.é­š.åµ' },
            { name: 'æ˜“æ€’ä¸è€ç…©', rec: 'B.éˆ£.é­š' },
            { name: 'è¡€è„‚åé«˜', rec: 'B.åµ.èŒ¶.ç´ ' },
            { name: 'ä¸‰Cæ—', rec: 'A.B.è‘‰é»ƒç´ ' }
        ];

        // ====== é¡åˆ¥å°ç…§è¡¨ï¼šç”Ÿæ´»å‹æ…‹æ¯é¡Œå‹¾é¸æ™‚ï¼Œå°æ‡‰å“ªäº›ç‡Ÿé¤Šé¡åˆ¥æœƒè¢«ã€Œé€£å‹•ã€å‹¾é¸ï¼ˆåƒ…è¦–è¦ºé¡¯ç¤ºç”¨ï¼‰ ======
        const categoryMapping = {
            '1': ['A','B','C','D','E','CaMg','FE','çº–ç¶­','è›‹ç™½è³ª','å¾®é‡å…ƒç´ '], /* é¡Œ1 å°æ‡‰å¤šé¡åˆ¥ */
            '2': ['A','B','C','E','çº–ç¶­','å¾®é‡å…ƒç´ '],
            '3': ['B','E','FE','çº–ç¶­','å¾®é‡å…ƒç´ '],
            '4': ['A','B','D','CaMg','è›‹ç™½è³ª'],
            '5': ['CaMg','FE','å¾®é‡å…ƒç´ '],
            '6': ['D','FE','è›‹ç™½è³ª','å¾®é‡å…ƒç´ '],
            '7': ['B','C','E'],
            '8': ['A','C','E','FE'],
            '9': ['A','B','C','D','E','CaMg','FE','çº–ç¶­','è›‹ç™½è³ª','å¾®é‡å…ƒç´ '] /* é¡Œ9 å¹¾ä¹å…¨åŒ…å« */
        };

        // ====== å‹•æ…‹æ’å…¥ç—‡ç‹€è¡¨æ ¼ï¼ˆ6åˆ—å‡åˆ†ï¼‰ ======
        function injectSymptoms() {
            const symptomList = document.querySelector('#questionnairePage .symptom-list'); /* å®¹å™¨ç¯€é» */
            const rowCount = 6; /* 6åˆ—å‘ˆç¾ */
            const itemsPerRow = Math.ceil(symptoms.length / rowCount); /* æ¯åˆ—æ”¾ç½®çš„é …ç›®æ•¸ */
            const symptomTable = document.createElement('table'); /* ç”Ÿæˆè¡¨æ ¼ */
            symptomTable.className = 'symptom-table'; /* æŒ‡å®šè¡¨æ ¼é¡åˆ¥ï¼ˆæ¨£å¼æ²¿ç”¨çˆ¶å±¤ï¼‰ */
            for (let row = 0; row < rowCount; row++) { /* é€åˆ—å»ºç«‹ */
                const tr = document.createElement('tr'); /* æ–°åˆ— */
                for (let col = 0; col < itemsPerRow; col++) { /* é€æ¬„å»ºç«‹ */
                    const index = row * itemsPerRow + col; /* è¨ˆç®—å…¨åŸŸç´¢å¼• */
                    const td = document.createElement('td'); /* æ–°å„²å­˜æ ¼ */
                    if (index < symptoms.length) { /* é‚Šç•Œæª¢æŸ¥ï¼šè¶…å‡ºä¸æ”¾è³‡æ–™ */
                        const item = symptoms[index]; /* å–å¾—ç—‡ç‹€è³‡æ–™ */
                        const id = 'symptom_' + index; /* å”¯ä¸€ id */
                        td.innerHTML = `<input type="checkbox" id="${id}" name="symptom" value="${item.name}" data-rec="${item.rec}">` + /* å‹¾é¸ç—‡ç‹€ */
                                       `<label for="${id}"> ${item.name} <span style="color: #888; font-size: 12px;">(${item.rec})</span></label>`; /* é¡¯ç¤ºåç¨± + å»ºè­° */
                    }
                    tr.appendChild(td); /* åŠ å…¥å„²å­˜æ ¼ */
                }
                symptomTable.appendChild(tr); /* åˆ—åŠ å…¥è¡¨æ ¼ */
            }
            symptomList.innerHTML = ''; /* æ¸…ç©ºå®¹å™¨ */
            symptomList.appendChild(symptomTable); /* æ’å…¥æ–°è¡¨æ ¼ */
        }

        // ====== è¨ˆç®—ç”Ÿæ´»å‹æ…‹åˆ†æ•¸ï¼ˆæ¯é¡Œ 2 åˆ†ï¼Œä¾æ“šé¡åˆ¥æ¬„ä½ç›®å‰è¢«å‹¾é¸çš„æ•¸é‡ * 2ï¼‰ ======
        function computeScore() {
            const categoryChecks = document.querySelectorAll('.category:checked'); /* å–å¾—æ‰€æœ‰è¢«é€£å‹•å‹¾é¸çš„é¡åˆ¥æ¬„ */
            let total = categoryChecks.length * 2; /* ä»¥ 2 åˆ†/é …æ›ç®—ç¸½åˆ† */
            document.getElementById('lifestyleResult').textContent = 'ç”Ÿæ´»å‹æ…‹åˆ†æ•¸ï¼š' + total + ' åˆ†'; /* é¡¯ç¤ºçµæœ */
        }
        window.computeScore = computeScore; /* ä½¿ HTML onclick å¯å‘¼å« */


        // ====== ä¾æ“šæ˜¯å¦å‹¾é¸ï¼ˆä½¿ç”¨è€…çš„ life-checkboxï¼‰å»å‹¾/å–æ¶ˆ é¡åˆ¥æ¬„ä½ ======
        function updateCategories(row, isChecked) {
            const categoriesForRow = categoryMapping[String(row)] || Array.from(
                document.querySelectorAll(`input.category[data-row="${row}"]`)
            ).map(catInput => catInput.dataset.cat); /* è‹¥ç„¡å°ç…§è¡¨å‰‡ä¾ç•«é¢ç¾æœ‰æ¬„ä½ */
            categoriesForRow.forEach(cat => {
                const catCheckbox = document.querySelector(
                    `input.category[data-row="${row}"][data-cat="${cat}"]`
                );
                if (catCheckbox) {
                    catCheckbox.checked = isChecked; /* åŒæ­¥å‹¾é¸ç‹€æ…‹ */
                }
            });
        }

        // ====== å„²å­˜ï¼šå°‡å•å·é é¢ï¼ˆå¡«å¯«å¾Œï¼‰è¤‡è£½æˆå–®ç¨ HTMLï¼Œå¯«å…¥ localStorage ä¸¦é–‹æ–°è¦–çª—é è¦½ ======
        function saveSubmission(form) {
            const nameVal = form.querySelector('input[name="name"]').value.trim(); /* ä»¥å§“åä½œç‚ºæª”å Key */
            if (!nameVal) return; /* æ²’å¡«å§“åå‰‡ä¸å„²å­˜ */

            const clone = document.documentElement.cloneNode(true); /* è¤‡è£½æ•´ä»½æ–‡ä»¶ï¼ˆæ·±å±¤ï¼‰ */

            /* ç§»é™¤é¦–é èˆ‡ç®¡ç†é ï¼Œåªä¿ç•™å•å·é èˆ‡çµæœ */
            const homeEl = clone.querySelector('#homePage');
            if (homeEl) homeEl.remove();
            const manageEl = clone.querySelector('#managePage');
            if (manageEl) manageEl.remove();

            /* ç¢ºä¿å•å·é é¡¯ç¤ºï¼ˆé¿å…å¦å­˜å¾Œä»ç‚º display:noneï¼‰ */
            const qPage = clone.querySelector('#questionnairePage');
            if (qPage) {
                qPage.style.display = 'block';
            }

            /* å°‡åŸé é¢çš„è¼¸å…¥å€¼è¤‡è£½åˆ°å…‹éš†é ï¼ˆåœ¨ç¦ç”¨å‰åŒæ­¥ï¼‰ */
            (function copyValues() {
                const originalInputs = document.querySelectorAll('#questionnairePage input, #questionnairePage select, #questionnairePage textarea'); /* åŸè¼¸å…¥å…ƒä»¶ */
                const clonedInputs = clone.querySelectorAll('#questionnairePage input, #questionnairePage select, #questionnairePage textarea'); /* è¤‡è£½å“ä¸­çš„è¼¸å…¥å…ƒä»¶ */
                originalInputs.forEach((orig, idx) => {
                    const cloned = clonedInputs[idx]; /* å°ä½å…ƒç´  */
                    if (!cloned) return;
                    const tag = orig.tagName.toLowerCase();
                    if (tag === 'input') {
                        const type = orig.type;
                        if (type === 'checkbox' || type === 'radio') {
                            cloned.checked = orig.checked; /* å‹¾é¸åŒæ­¥ */
                        } else {
                            cloned.value = orig.value; /* æ–‡å­—/æ•¸å­—åŒæ­¥ */
                        }
                    } else if (tag === 'select') {
                        cloned.value = orig.value; /* ä¸‹æ‹‰é¸æ“‡åŒæ­¥ */
                    } else if (tag === 'textarea') {
                        cloned.value = orig.value; /* æ–‡æœ¬æ¡†åŒæ­¥ */
                    }
                });
            })();

            /* ç¦ç”¨å…‹éš†é çš„äº’å‹•ï¼ˆé˜²æ­¢å¦å­˜é é‚„èƒ½æ“ä½œï¼‰ */
            clone.querySelectorAll('#questionnairePage input, #questionnairePage select, #questionnairePage textarea, #questionnairePage button').forEach(el => {
                el.disabled = true; /* ç¦ç”¨äº’å‹• */
                el.readOnly = true; /* è¨­å”¯è®€ï¼ˆä¿éšªï¼‰ */
            });

            /* ç§»é™¤æ‰€æœ‰ <script>ï¼Œé¿å…å¦å­˜é åŸ·è¡ŒåŸæœ¬é‚è¼¯ */
            clone.querySelectorAll('script').forEach(scr => scr.remove());

            /* ç”¨å§“åè¦†è“‹å¦å­˜é çš„ <title>ï¼Œæ–¹ä¾¿è¾¨è­˜ */
            const titleEl = clone.querySelector('title');
            if (titleEl) titleEl.textContent = nameVal;

            const savedHtml = '<!DOCTYPE html>' + clone.outerHTML; /* ä¸²å›å®Œæ•´ HTML å­—ä¸² */

            /* æ›´æ–°å§“åæ¸…å–®ï¼ˆé¿å…é‡è¤‡åŠ å…¥ï¼‰ */
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || []; /* è®€å–æ—¢æœ‰æ¸…å–® */
            } catch (e) {
                names = []; /* è®€å–å¤±æ•—å‰‡é‡ç½® */
            }
            if (!names.includes(nameVal)) {
                names.push(nameVal); /* æ–°å¢å§“å */
                localStorage.setItem('savedNames', JSON.stringify(names)); /* å¯«å›æ¸…å–® */
            }

            /* ä»¥ key: savedPage_å§“å ä¿å­˜æ•´é  HTML å…§å®¹ */
            localStorage.setItem('savedPage_' + nameVal, savedHtml);

            /* å¦é–‹è¦–çª—é è¦½ä¿å­˜æˆæœ */
            const newWin = window.open();
            if (newWin) {
                newWin.document.write(savedHtml); /* å¯«å…¥ HTML */
                newWin.document.close(); /* å®Œæˆè¼‰å…¥ */
            }
        }

        // ====== ç®¡ç†é é¢ï¼šå»ºç«‹æ¸…å–®è¡¨ï¼ˆæœ€å¤šé¡¯ç¤º 4 ç­†ï¼‰ï¼Œå¯é»é–‹ / åˆªé™¤ ======
        function buildManageTable() {
            const table = document.getElementById('manageTable'); /* ç›®æ¨™è¡¨æ ¼ */
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || []; /* è®€å–å§“åæ¸…å–® */
            } catch (e) {
                names = [];
            }
            const rowCount = 4; /* æœ€å¤šé¡¯ç¤º 4 è¡Œï¼ˆä¸è¶³ä»¥ç©ºç™½ä½”ä½ï¼‰ */
            table.innerHTML = ''; /* æ¸…ç©ºèˆŠå…§å®¹ */
            for (let i = 0; i < rowCount; i++) {
                const tr = document.createElement('tr'); /* æ–°åˆ— */
                const nameTd = document.createElement('td'); /* å§“åå„²å­˜æ ¼ */
                const deleteTd = document.createElement('td'); /* åˆªé™¤éµå„²å­˜æ ¼ */
                if (i < names.length) {
                    const name = names[i]; /* å–å°æ‡‰å§“å */
                    const link = document.createElement('a'); /* å¯é»æ“Šé–‹å•Ÿå„²å­˜é  */
                    link.href = '#';
                    link.textContent = name;
                    link.addEventListener('click', function(ev) {
                        ev.preventDefault();
                        openSavedPage(name); /* æ‰“é–‹å„²å­˜é  */
                    });
                    nameTd.appendChild(link);
                    const delBtn = document.createElement('button'); /* åˆªé™¤æŒ‰éˆ• */
                    delBtn.textContent = 'åˆªé™¤';
                    delBtn.className = 'delete-btn';
                    delBtn.addEventListener('click', function(ev) {
                        ev.preventDefault();
                        deleteEntry(name); /* åˆªé™¤è©²ç­†è³‡æ–™ */
                    });
                    deleteTd.appendChild(delBtn);
                } else {
                    /* è‹¥æ²’æœ‰è³‡æ–™ï¼Œè£œç©ºç™½è¡Œä»¥ç¶­æŒè¡¨æ ¼é«˜åº¦ */
                    nameTd.innerHTML = '&nbsp;';
                    deleteTd.innerHTML = '&nbsp;';
                }
                tr.appendChild(nameTd);
                tr.appendChild(deleteTd);
                table.appendChild(tr);
            }
        }

        // ====== åˆªé™¤è³‡æ–™ï¼šç§»é™¤å§“åæ¸…å–®èˆ‡å…¶å°æ‡‰çš„å„²å­˜é  ======
        function deleteEntry(name) {
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || []; /* è®€å–æ¸…å–® */
            } catch (e) {
                names = [];
            }
            const newNames = names.filter(n => n !== name); /* éæ¿¾æ‰ç›®æ¨™å§“å */
            localStorage.setItem('savedNames', JSON.stringify(newNames)); /* å¯«å›æ¸…å–® */
            localStorage.removeItem('savedPage_' + name); /* ç§»é™¤å°æ‡‰å„²å­˜é  */
            buildManageTable(); /* é‡æ–°æ¸²æŸ“è¡¨æ ¼ */
        }

        // ====== é–‹å•Ÿå„²å­˜çš„å€‹åˆ¥é é¢ï¼ˆæ–°è¦–çª—ï¼‰ ======
        function openSavedPage(name) {
            const html = localStorage.getItem('savedPage_' + name); /* è®€å– HTML å­—ä¸² */
            if (html) {
                const win = window.open();
                if (win) {
                    win.document.write(html); /* è¼¸å‡ºå…§å®¹ */
                    win.document.close();
                }
            } else {
                alert('ç„¡æ³•æ‰¾åˆ°è©²è³‡æ–™é é¢ã€‚'); /* æ‰¾ä¸åˆ°æ™‚æç¤º */
            }
        }

        // ====== DOM è¼‰å…¥å®Œæˆå¾Œç¶å®šäº‹ä»¶èˆ‡åˆå§‹åŒ– ======
        document.addEventListener('DOMContentLoaded', () => {
            /* ç¬¬ä¸€æ¬¡è¼‰å…¥æ™‚é è¨­æ”¾å…¥ä¸€ç­†ç¯„ä¾‹ï¼Œè®“ç®¡ç†é æœ‰è³‡æ–™å¯æ¼”ç¤º */
            try {
                let initNames = JSON.parse(localStorage.getItem('savedNames')) || []; /* è®€æ¸…å–® */
                if (!Array.isArray(initNames) || initNames.length === 0) {
                    const defaultName = 'ç‹å¤§æ˜'; /* ç¯„ä¾‹å§“å */
                    initNames = [defaultName];
                    localStorage.setItem('savedNames', JSON.stringify(initNames));
                    const dummyPage = '<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><title>' + defaultName + '</title></head><body><h1>' + defaultName + 'çš„å•å·è³‡æ–™</h1><p>é€™æ˜¯ä¸€å€‹è™›æ§‹çš„ç¯„ä¾‹è³‡æ–™ï¼Œç”¨ä¾†å±•ç¤ºè³‡æ–™ç®¡ç†åŠŸèƒ½ã€‚</p></body></html>';
                    localStorage.setItem('savedPage_' + defaultName, dummyPage);
                }
            } catch (err) {
                /* è‹¥è®€å–å¤±æ•—å‰‡é‡ç½®ä¸¦å¡å…¥é è¨­å€¼ */
                const defaultName = 'ç‹å¤§æ˜';
                localStorage.setItem('savedNames', JSON.stringify([defaultName]));
                const dummyPage = '<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><title>' + defaultName + '</title></head><body><h1>' + defaultName + 'çš„å•å·è³‡æ–™</h1><p>é€™æ˜¯ä¸€å€‹è™›æ§‹çš„ç¯„ä¾‹è³‡æ–™ï¼Œç”¨ä¾†å±•ç¤ºè³‡æ–™ç®¡ç†åŠŸèƒ½ã€‚</p></body></html>';
                localStorage.setItem('savedPage_' + defaultName, dummyPage);
            }

            injectSymptoms(); /* ç”¢ç”Ÿç—‡ç‹€è¡¨æ ¼ */

            /* ç”Ÿæ´»å‹æ…‹é¡Œç›®çš„ã€Œæ˜¯å¦ã€å‹¾é¸ â†’ é€£å‹•ä¸Šæ–¹é¡åˆ¥æ¬„ä½ */
            document.querySelectorAll('.life-checkbox').forEach(chk => {
                chk.addEventListener('change', function() {
                    const row = this.dataset.row; /* å–å¾—è©²åˆ—ç·¨è™Ÿ */
                    updateCategories(row, this.checked); /* å‹¾é¸ç‹€æ…‹åŒæ­¥åˆ°é¡åˆ¥æ¬„ */
                });
            });

            /* è‡ªå‹•è¨ˆç®— BMIï¼šç•¶èº«é«˜æˆ–é«”é‡è®Šå‹•æ™‚é‡æ–°è¨ˆç®— */
            (function() {
                const heightInput = document.querySelector('input[name="height"]'); /* èº«é«˜è¼¸å…¥ */
                const weightInput = document.querySelector('input[name="weight"]'); /* é«”é‡è¼¸å…¥ */
                const bmiInput = document.querySelector('input[name="bmi"]'); /* BMI é¡¯ç¤ºæ¬„ */

                function calculateBMI() {
                    const h = parseFloat(heightInput.value); /* å–å¾—èº«é«˜ï¼ˆcmï¼‰ */
                    const w = parseFloat(weightInput.value); /* å–å¾—é«”é‡ï¼ˆkgï¼‰ */
                    if (h > 0 && w > 0) {
                        const heightM = h / 100.0; /* æ›ç®—å…¬å°º */
                        const bmi = w / (heightM * heightM); /* BMI è¨ˆç®— */
                        bmiInput.value = bmi.toFixed(1); /* å°æ•¸ä¸€ä½ */
                    } else {
                        bmiInput.value = ''; /* æ¢ä»¶ä¸å®Œæ•´å‰‡æ¸…ç©º */
                    }
                }
                if (heightInput && weightInput && bmiInput) {
                    heightInput.addEventListener('input', calculateBMI); /* ç›£è½èº«é«˜è¼¸å…¥ */
                    weightInput.addEventListener('input', calculateBMI); /* ç›£è½é«”é‡è¼¸å…¥ */
                }
            })();

            /* ç•¶é£²æ°´ç¨®é¡é¸ã€Œå®¶ç”¨æ·¨æ°´å™¨ã€æ™‚é¡¯ç¤ºå“ç‰Œ/é¡å‹è¼¸å…¥æ¬„ */
            (function() {
                const waterSelect = document.getElementById('waterTypeSelect'); /* é£²æ°´ç¨®é¡é¸å–® */
                const waterInfo = document.getElementById('waterFilterInfo'); /* é¡å¤–è³‡è¨Šæ¬„ä½ */
                if (waterSelect && waterInfo) {
                    waterSelect.addEventListener('change', function() {
                        if (this.value === 'å®¶ç”¨æ·¨æ°´å™¨') {
                            waterInfo.style.display = 'block'; /* é¡¯ç¤º */
                        } else {
                            waterInfo.style.display = 'none'; /* éš±è— */
                        }
                    });
                }
            })();

            /* è¡¨å–®é€å‡ºï¼šæ•´ç†çµæœã€é¡¯ç¤ºæ–¼ä¸‹æ–¹ã€ä¸¦å¦å­˜ç‚ºç¨ç«‹é é¢ */
            document.getElementById('questionnaire').addEventListener('submit', function(e) {
                e.preventDefault(); /* é˜»æ­¢é è¨­æäº¤åˆ·æ–°é é¢ */
                const formData = new FormData(this); /* æ”¶é›†è¡¨å–®è³‡æ–™ */

                /* è’é›†å‹¾é¸çš„ç—‡ç‹€èˆ‡å°æ‡‰å»ºè­° */
                const selectedSymptoms = [];
                document.querySelectorAll('input[name="symptom"]:checked').forEach(chk => {
                    selectedSymptoms.push({ name: chk.value, rec: chk.dataset.rec }); /* e.g. { name:'åˆ·ç‰™æµè¡€', rec:'C' } */
                });

                /* è¨ˆç®—åˆ†æ•¸ï¼šä»¥å·²è¢«å‹¾é¸çš„é¡åˆ¥æ¬„ä½æ•¸è¨ˆåˆ†ï¼ˆ*2ï¼‰ */
                let lifestyleScore = document.querySelectorAll('.category:checked').length * 2;

                /* çµ„è£è¼¸å‡º HTMLï¼ˆé¡¯ç¤ºåœ¨ formOutputï¼‰ */
                let output = '<h3>å¡«å¯«çµæœ</h3>';
                output += '<p><strong>å§“åï¼š</strong>' + (formData.get('name') || '') + '</p>';
                output += '<p><strong>æ€§åˆ¥ï¼š</strong>' + (formData.get('gender') || '') + '</p>';
                output += '<p><strong>å¹´é½¡ï¼š</strong>' + (formData.get('age') || '') + '</p>';
                output += '<p><strong>ç”Ÿæ´»å‹æ…‹åˆ†æ•¸ï¼š</strong>' + lifestyleScore + ' åˆ†</p>';

                if (selectedSymptoms.length > 0) {
                    output += '<p><strong>å‹¾é¸çš„ç—‡ç‹€èˆ‡å»ºè­°ï¼š</strong></p><ul>';
                    selectedSymptoms.forEach(item => {
                        output += '<li>' + item.name + ' â€” æ¨è–¦ï¼š' + item.rec + '</li>'; /* åˆ—å‡ºæ¯å€‹ç—‡ç‹€èˆ‡å»ºè­° */
                    });
                    output += '</ul>';

                    /* çµ±è¨ˆå»ºè­°ç‡Ÿé¤Šç´ å‡ºç¾æ¬¡æ•¸ï¼ˆä»¥ . åˆ†éš”ï¼‰ */
                    const nutrientCounts = {};
                    selectedSymptoms.forEach(item => {
                        item.rec.split('.').forEach(nutrient => {
                            const trimmed = nutrient.trim();
                            if (trimmed) {
                                nutrientCounts[trimmed] = (nutrientCounts[trimmed] || 0) + 1; /* å‡ºç¾æ¬¡æ•¸ +1 */
                            }
                        });
                    });

                    const summaryParts = Object.keys(nutrientCounts).map(key => key + '*' + nutrientCounts[key]); /* è½‰ç‚ºé™£åˆ—ï¼šå¦‚ "C*3" */
                    if (summaryParts.length > 0) {
                        const summaryLines = summaryParts.map(part => 'ã€‚' + part).join('<br>'); /* æ¯é …æ›è¡Œé¡¯ç¤º */
                        output += '<p><strong>ç¼ºä¹ç‡Ÿé¤Šç´ çµ±è¨ˆï¼š</strong><br>' + summaryLines + '</p>'; /* é¡¯ç¤ºçµ±è¨ˆ */
                    }
                } else {
                    output += '<p><strong>æœªå‹¾é¸ç—‡ç‹€ã€‚</strong></p>'; /* ç„¡å‹¾é¸æ™‚æç¤º */
                }

                document.getElementById('formOutput').innerHTML = output; /* è¼¸å‡ºè‡³é é¢ */

                saveSubmission(this); /* å¦å­˜ç‚ºå–®ç¨ HTML ä¸¦é–‹æ–°è¦–çª— */
            });

            /* å°è¦½ï¼šé¦–é â†’å•å· */
            document.getElementById('btnQuestionnaire').addEventListener('click', function() {
                document.getElementById('homePage').style.display = 'none'; /* éš±è—é¦–é  */
                document.getElementById('managePage').style.display = 'none'; /* éš±è—ç®¡ç†é  */
                document.getElementById('questionnairePage').style.display = 'block'; /* é¡¯ç¤ºå•å·é  */
            });

            /* å°è¦½ï¼šé¦–é â†’ç®¡ç†é  */
            document.getElementById('btnManage').addEventListener('click', function() {
                document.getElementById('homePage').style.display = 'none'; /* éš±è—é¦–é  */
                document.getElementById('questionnairePage').style.display = 'none'; /* éš±è—å•å·é  */
                document.getElementById('managePage').style.display = 'block'; /* é¡¯ç¤ºç®¡ç†é  */
                buildManageTable(); /* ç”Ÿæˆç®¡ç†è¡¨æ ¼ */
            });

            /* å•å·é  â†’ å›é¦–é  */
            const returnHomeBtn = document.getElementById('btnReturnHome');
            if (returnHomeBtn) {
                returnHomeBtn.addEventListener('click', function() {
                    document.getElementById('homePage').style.display = 'block'; /* é¡¯ç¤ºé¦–é  */
                    document.getElementById('questionnairePage').style.display = 'none'; /* éš±è—å•å·é  */
                    document.getElementById('managePage').style.display = 'none'; /* éš±è—ç®¡ç†é  */
                    document.getElementById('formOutput').innerHTML = ''; /* æ¸…ç©ºçµæœè¼¸å‡º */
                    // document.getElementById('questionnaire').reset(); /* è‹¥è¦åŒæ™‚é‡ç½®è¡¨å–®ï¼Œå¯è§£é™¤è¨»è§£ */
                });
            }

            /* ç®¡ç†é  â†’ å›é¦–é  */
            const manageReturnBtn = document.getElementById('btnManageReturnHome');
            if (manageReturnBtn) {
                manageReturnBtn.addEventListener('click', function() {
                    document.getElementById('homePage').style.display = 'block'; /* é¡¯ç¤ºé¦–é  */
                    document.getElementById('questionnairePage').style.display = 'none'; /* éš±è—å•å·é  */
                    document.getElementById('managePage').style.display = 'none'; /* éš±è—ç®¡ç†é  */
                });
            }
        });
    </script>
</body>
</html>
