<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¿Nurtiliteç”Ÿæ´»ç‡Ÿé¤Šå•å·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            /* Remove the green-tinted page background and use pure white. */
            background: #ffffff;
            color: #333;
            min-height: 100vh;
        }
        h1, h2 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        section {
            margin-bottom: 40px;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin-bottom: 8px;
        }
        input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f0f0f0;
        }
        /* Style for the symptom table layout */
        .symptom-list table {
            width: 100%;
            border-collapse: collapse;
        }
        .symptom-list td {
            border: 1px solid #ddd;
            padding: 4px;
            vertical-align: top;
        }
        /* Ensure checkboxes and labels align nicely within symptom table cells */
        .symptom-list input[type="checkbox"] {
            margin-right: 4px;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #3498db;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 10px 0 0;
        }
        .btn:hover {
            background: #2980b9;
        }
        /*
         * Custom home page styles to match the uploaded mockup.
         * A header displays a sprout icon centered above the page title,
         * and a container framed by a decorative vine border.  The two
         * main buttons are centered within this container.  The vine
         * border and sprout icon are provided as separate image files in
         * the same folder as the HTML.  To update the look, replace
         * vine_panel.jpeg or sprout_icon_final_clean.jpeg with your own
         * assets and adjust the CSS as needed.
         */
        .home-header {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .home-header img {
            display: block;
            margin: 0 auto 8px auto;
            width: 80px;
            height: auto;
        }
        .home-header h1 {
            font-size: 2rem;
            margin: 0;
            color: #2c3e50;
        }
        .home-container {
            /* Use the vine border with complete frame.  The file
             * vine_panel_complete.png provides a decorative border around
             * the home page container.  */
            background-image: url('vine_panel_complete.png');
            /* Scale the vine border image proportionally so the entire frame is visible */
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            /* Allow the underlying page color to show inside the frame */
            background-color: transparent;
            /* Set container width to allow space for the full frame */
            max-width: 700px;
            width: 90%;
            margin: 0 auto;
            /* Padding equal on all sides to keep buttons inside the border */
            padding: 80px 60px;
            box-sizing: border-box;
            /* Minimum height approximates the aspect ratio of the frame */
            min-height: 450px;
            /* Center content vertically and horizontally so the buttons sit
             * in the middle of the vine border container. */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /*
         * è¡Œå‹•ç«¯æ”¯æ´èˆ‡å„²å­˜é–å®šæ¨£å¼ï¼š
         *  - .table-scroll å¯è®“å¯¬åº¦è¶…å‡ºè¢å¹•çš„è¡¨æ ¼å·¦å³æ»‘å‹•ï¼Œé¿å…æ•´é æ’å‡ºæ°´å¹³æ²å‹•ã€‚
         *  - .lifestyle-table å’Œ .symptom-table è¨­å®šæœ€å°å¯¬åº¦ï¼Œä½¿å¤šæ¬„ä½è¡¨æ ¼åœ¨çª„è¢å¹•æ™‚ä»å¯é¡¯ç¤ºã€‚
         *  - .locked æ¨£å¼ç”¨æ–¼å„²å­˜é é¢ï¼Œå°‡è¡¨å–®å…ƒç´ è¨­ç‚ºä¸å¯äº’å‹•ï¼Œä½†ä¿æŒæ ¸å–æ–¹å¡Šå¯è¦‹ã€‚
         */
        .table-scroll {
            /* Allow horizontal scrolling of wide tables on small screens.  */
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            /* Extend the section's green background across the entire scrollable area.
             * Without this, the portion of a table that overflows the viewport
             * would display on a white background.  By matching the section's
             * background color (#e8f5e9), the table appears on a continuous
             * green field even while scrolling horizontally on mobile. */
            background-color: #e8f5e9;
        }
        .lifestyle-table { min-width: 1100px; }
        .symptom-table   { min-width: 900px; }
        html, body { overflow-x: hidden; }
        img, table { max-width: 100%; }
        .locked input,
        .locked select,
        .locked textarea,
        .locked button {
            pointer-events: none !important;
        }
        .locked input[type="checkbox"],
        .locked input[type="radio"] {
            opacity: 1 !important;
        }
        @media (max-width: 480px) {
            section { padding: 12px; }
            .btn { padding: 12px 14px; font-size: 16px; }
            .home-container { padding: 24px; }
        }
        .home-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            width: 100%;
        }

        /* Enlarge only the two buttons on the home page.  Use the
         * identifiers to avoid affecting other .btn buttons in the
         * questionnaire or management pages.  The extra padding
         * increases the button size, while a larger font improves
         * readability on smaller screens. */
      /* æ¡Œé¢ç‰ˆï¼ˆé è¨­ï¼‰ */
#btnQuestionnaire.btn,
#btnManage.btn {
    padding: 40px 30px;
    font-size: 28px;
}

/* æ‰‹æ©Ÿç‰ˆï¼ˆè¢å¹•å¯¬åº¦ â‰¤ 768pxï¼‰ */
@media (max-width: 768px) {
    #btnQuestionnaire.btn,
    #btnManage.btn {
        padding: 20px 15px;  /* æ‰‹æ©Ÿç‰ˆç¸®å°å…§è· */
        font-size: 18px;     /* æ‰‹æ©Ÿç‰ˆç¸®å°å­—é«” */
    }
}

        /* Style for manage page delete and add buttons */
        .delete-btn {
            background: #e74c3c;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
        }
        .delete-btn:hover {
            background: #c0392b;
        }
        .add-btn {
            display: inline-block;
            margin-bottom: 10px;
            padding: 8px 16px;
            background: #27ae60;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .add-btn:hover {
            background: #1e8449;
        }
        .result {
            margin-top: 10px;
            font-weight: bold;
            color: #e67e22;
        }

        /* Center the title in the management page */
        #managePage h1 {
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Home view -->
    <div id="homePage">
        <div class="home-header">
            <!-- Update the home page heading per user request -->
            <h1>ğŸŒ¿Nurtiliteç”Ÿæ´»ç‡Ÿé¤Šå•å·</h1>
        </div>
        <!-- Vine border container with buttons inside -->
        <div class="home-container">
            <div class="home-buttons">
                <button id="btnQuestionnaire" class="btn">ç”Ÿæ´»ç‡Ÿé¤Šå•å·</button>
                <button id="btnManage" class="btn">å•å·è³‡æ–™ç®¡ç†</button>
            </div>
        </div>
    </div>
    <!-- Questionnaire view -->
    <div id="questionnairePage" style="display:none;">
        <h1>ğŸŒ¿ ç”Ÿæ´»å‹æ…‹èˆ‡ç‡Ÿé¤Šå•å·</h1>
        <form id="questionnaire">
            <section>
                <h2>ä¸€ã€åŸºæœ¬è³‡æ–™</h2>
                <label>å§“å
                    <input type="text" name="name" required>
                </label>
                <label>æ€§åˆ¥
                    <select name="gender" required>
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç”·">ç”·</option>
                        <option value="å¥³">å¥³</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </label>
                <label>å¹´é½¡
                    <input type="number" name="age" min="0">
                </label>
                <label>æ˜Ÿåº§
                    <select name="zodiac">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç‰¡ç¾Šåº§">ç‰¡ç¾Šåº§</option>
                        <option value="é‡‘ç‰›åº§">é‡‘ç‰›åº§</option>
                        <option value="é›™å­åº§">é›™å­åº§</option>
                        <option value="å·¨èŸ¹åº§">å·¨èŸ¹åº§</option>
                        <option value="ç…å­åº§">ç…å­åº§</option>
                        <option value="è™•å¥³åº§">è™•å¥³åº§</option>
                        <option value="å¤©ç§¤åº§">å¤©ç§¤åº§</option>
                        <option value="å¤©è åº§">å¤©è åº§</option>
                        <option value="å°„æ‰‹åº§">å°„æ‰‹åº§</option>
                        <option value="é­”ç¾¯åº§">é­”ç¾¯åº§</option>
                        <option value="æ°´ç“¶åº§">æ°´ç“¶åº§</option>
                        <option value="é›™é­šåº§">é›™é­šåº§</option>
                    </select>
                </label>
                <label>è·æ¥­
                    <input type="text" name="occupation">
                </label>
                <label>å­¸æ­·
                    <input type="text" name="education">
                </label>
                <label>èº«é«˜ (cm)
                    <input type="number" name="height" min="0" step="0.1">
                </label>
                <label>é«”é‡ (kg)
                    <input type="number" name="weight" min="0" step="0.1">
                </label>
                <label>BMI
                    <input type="number" name="bmi" step="0.1" readonly>
                </label>
                <label>é›»è©±æˆ– LINE ID
                    <input type="text" name="contact">
                </label>
                <label>å°±å¯¢æ™‚é–“
                    <select name="sleep_time">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="10:00~11:00">10:00~11:00</option>
                        <option value="11:00~12:00">11:00~12:00</option>
                        <option value="12:00~1:00">12:00~1:00</option>
                        <option value="1:00~">1:00~</option>
                        <option value="é€šå®µæœªç¨…">é€šå®µæœªç¨…</option>
                    </select>
                </label>
                <label>æ—©é¤æ™‚é–“
                    <select name="breakfast_time">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="6:00~7:00">6:00~7:00</option>
                        <option value="7:00~8:00">7:00~8:00</option>
                        <option value="8:00~9:00">8:00~9:00</option>
                        <option value="9:00~">9:00~</option>
                        <option value="ç¶“å¸¸æ²’åƒæ—©é¤">ç¶“å¸¸æ²’åƒæ—©é¤</option>
                    </select>
                </label>
                <label>é£²æ°´ç¨®é¡
                    <select name="water_type" id="waterTypeSelect">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="ç™½é–‹æ°´">ç™½é–‹æ°´</option>
                        <option value="ç¤¦æ³‰æ°´">ç¤¦æ³‰æ°´</option>
                        <option value="é£²æ–™">é£²æ–™</option>
                        <option value="å®¶ç”¨æ·¨æ°´å™¨">å®¶ç”¨æ·¨æ°´å™¨</option>
                    </select>
                </label>
                <!-- Additional input appears when 'å®¶ç”¨æ·¨æ°´å™¨' is selected -->
                <div id="waterFilterInfo" style="display:none; margin-top: 8px;">
                    <label>æ·¨æ°´å™¨å“ç‰Œèˆ‡é¡å‹
                        <input type="text" name="water_filter_info">
                    </label>
                </div>
                <label>æ˜¯å¦æœç”¨ç‡Ÿé¤Šè£œå……å“
                    <select name="supplements">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="æ²’æœ‰">æ²’æœ‰</option>
                        <option value="å¶çˆ¾">å¶çˆ¾</option>
                        <option value="æ›¾ç¶“">æ›¾ç¶“</option>
                        <option value="ç¾åœ¨">ç¾åœ¨</option>
                    </select>
                </label>
                <label>é‹å‹•ç¿’æ…£
                    <select name="exercise">
                        <option value="">--è«‹é¸æ“‡--</option>
                        <option value="æ²’æœ‰">æ²’æœ‰</option>
                        <option value="å¶çˆ¾">å¶çˆ¾</option>
                        <option value="è¦å¾‹">è¦å¾‹</option>
                    </select>
                </label>
                <label>æ…¢æ€§ç–¾ç—…
                    <input type="text" name="chronic">
                </label>
            </section>
            <section>
                <h2>äºŒã€ç”Ÿæ´»å‹æ…‹è©•ä¼° (æ¯é¡Œ 2 åˆ†)</h2>
                <!-- å°‡è¡¨æ ¼åŒ…åœ¨ table-scrollï¼Œä¸¦è¨­ç½® lifestyle-table ä»¥åœ¨çª„è¢å¹•å¯æ©«å‘æ»‘å‹• -->
                <div class="table-scroll">
                <table class="lifestyle-table">
                    <thead>
                        <tr>
                            <th>é¡Œè™Ÿ</th>
                            <th>è˜‹æœ579 ç–¾ç—…ç‡Ÿé¤Šéˆæˆ‘</th>
                            <th>A</th>
                            <th>B</th>
                            <th>C</th>
                            <th>D</th>
                            <th>E</th>
                            <th>CaMg</th>
                            <th>FE</th>
                            <th>çº–ç¶­</th>
                            <th>è›‹ç™½è³ª</th>
                            <th>å¾®é‡å…ƒç´ </th>
                            <th>æ˜¯å¦</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-row="1">
                            <td>1</td>
                            <td>æˆ‘æ¯å¤©éƒ½æœƒåƒ2ç¢—</td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="1" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life1" class="lifestyle-item life-checkbox" data-row="1"></td>
                        </tr>
                        <tr data-row="2">
                            <td>2</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è”¬èœåŠæ°´æœå°æ–¼5ä»½</td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="2" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life2" class="lifestyle-item life-checkbox" data-row="2"></td>
                        </tr>
                        <tr data-row="3">
                            <td>3</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è‚‰ã€é­šå°æ–¼1.5ä»½ï¼ˆå…¨ç©€æ ¹è–é¡å°æ–¼0.5ä»½ï¼‰</td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="3" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life3" class="lifestyle-item life-checkbox" data-row="3"></td>
                        </tr>
                        <tr data-row="4">
                            <td>4</td>
                            <td>æˆ‘æ¯å¤©å–çš„ä¹³è£½å“å°‘æ–¼1.5æ¯</td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="4" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life4" class="lifestyle-item life-checkbox" data-row="4"></td>
                        </tr>
                        <tr data-row="5">
                            <td>5</td>
                            <td>æˆ‘æ¯å¤©å–çš„è±†æ¼¿æˆ–èŒ¶è‡³å°‘2æ¯</td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="5" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life5" class="lifestyle-item life-checkbox" data-row="5"></td>
                        </tr>
                        <tr data-row="6">
                            <td>6</td>
                            <td>æˆ‘æ¯å¤©åƒçš„è›‹ç™½è³ªé£Ÿç‰©å°æ–¼5ä»½ï¼ˆå¤§è±†è›‹ç™½å°‘æ–¼1ä»½ï¼‰</td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="6" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life6" class="lifestyle-item life-checkbox" data-row="6"></td>
                        </tr>
                        <tr data-row="7">
                            <td>7</td>
                            <td>æˆ‘å¸¸åƒåŠ å·¥é£Ÿå“</td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="7" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life7" class="lifestyle-item life-checkbox" data-row="7"></td>
                        </tr>
                        <tr data-row="8">
                            <td>8</td>
                            <td>æˆ‘æœ‰å¸è¸çš„ç¿’æ…£</td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="8" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life8" class="lifestyle-item life-checkbox" data-row="8"></td>
                        </tr>
                        <tr data-row="9">
                            <td>9</td>
                            <td>æˆ‘ç¶“å¸¸ç¯€é£Ÿä»¥æ¸›è¼•é«”é‡</td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="A" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="B" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="C" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="D" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="E" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="CaMg" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="FE" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="çº–ç¶­" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="è›‹ç™½è³ª" disabled></td>
                            <td><input type="checkbox" class="category" data-row="9" data-cat="å¾®é‡å…ƒç´ " disabled></td>
                            <td><input type="checkbox" name="life9" class="lifestyle-item life-checkbox" data-row="9"></td>
                        </tr>
                    </tbody>
                </table>
                </div><!-- end of table-scroll wrapper -->
                <button type="button" class="btn" onclick="computeScore()">è¨ˆç®—ç”Ÿæ´»å‹æ…‹åˆ†æ•¸</button>
                <div id="lifestyleResult" class="result"></div>
            </section>
            <!-- Motivational tip inserted between lifestyle assessment and symptoms -->
            <!-- Motivational phrase centered and enlarged per user request -->
            <p style="margin: 20px 0; font-weight: bold; font-size: 1.5rem; color: #1e7ec8; text-align: center;">
                çµ¦å°ææ–™åšå°äº‹ï¼ŒåŠ ä¸Šè¶³å¤ çš„æ™‚é–“ï¼Œäººé«”æ˜¯æœ€å¥½çš„é†«ç”Ÿ
            </p>
            <section>
                <h2>ä¸‰ã€ç—‡ç‹€èˆ‡ç‡Ÿé¤Šå»ºè­° (å‹¾é¸æ‚¨æœ‰çš„ç—‡ç‹€)</h2>
                <!-- ä½¿ç”¨ table-scroll åŒ…è¦†ç—‡ç‹€åˆ—è¡¨ï¼Œè®“è¶…å¯¬è¡¨æ ¼åœ¨æ‰‹æ©Ÿå¯æ©«å‘æ»‘å‹• -->
                <div class="table-scroll">
                    <div class="symptom-list">
                        <!-- Symptoms will be injected here by JS -->
                    </div>
                </div>
            </section>
            <button type="submit" class="btn">æäº¤è¡¨å–®</button>
            <button type="button" class="btn" id="btnReturnHome">å›é¦–é </button>
        </form>
        <div id="formOutput" class="result"></div>
    </div>
    <!-- Management view -->
    <div id="managePage" style="display:none;">
        <h1>å•å·è³‡æ–™ç®¡ç†</h1>
        <!-- Button to return to home from the manage page -->
        <button id="btnManageReturnHome" class="btn">å›é¦–é </button>
        <table id="manageTable"></table>
    </div>
    <script>
        // Define symptoms and recommendations with user-requested modifications

        /*
         * å°‡ç•¶å‰å¡«å¯«çš„è¡¨å–®å€¼åŒæ­¥åˆ°è¤‡è£½é é¢ä¸¦é–å®šä¸å¯ç·¨è¼¯ã€‚
         * cloneDoc ç‚ºè¤‡è£½å‡ºä¾†çš„ Documentï¼ˆç”± document.documentElement.cloneNode(true) å–å¾—ï¼‰ã€‚
         */
        function lockAndPreserve(formEl, cloneDoc) {
            const origEls  = formEl.querySelectorAll('input, select, textarea');
            const cloneEls = cloneDoc.querySelectorAll('input, select, textarea');
            origEls.forEach((orig, i) => {
                const c = cloneEls[i];
                if (!c) return;
                const tag = orig.tagName.toLowerCase();
                if (tag === 'input') {
                    const type = (orig.type || '').toLowerCase();
                    if (type === 'checkbox' || type === 'radio') {
                        c.checked = !!orig.checked;
                        if (c.checked) {
                            c.setAttribute('checked', 'checked');
                        } else {
                            c.removeAttribute('checked');
                        }
                    } else {
                        c.value = orig.value ?? '';
                        c.setAttribute('value', c.value);
                    }
                } else if (tag === 'select') {
                    const v = orig.value;
                    c.value = v;
                    Array.from(c.options).forEach(opt => {
                        if (opt.value === v) {
                            opt.setAttribute('selected', 'selected');
                        } else {
                            opt.removeAttribute('selected');
                        }
                    });
                } else if (tag === 'textarea') {
                    c.value = orig.value ?? '';
                    c.textContent = c.value;
                }
                // Only disable non-checkbox inputs. For checkboxes/radios,
                // avoid setting the disabled attribute so the checked state
                // remains visible even after locking. Pointer-events are
                // blocked via CSS (.locked) for all inputs.
                if (tag === 'input') {
                    const type = (orig.type || '').toLowerCase();
                    if (type === 'checkbox' || type === 'radio') {
                        // do not set disabled; leave as is
                    } else {
                        c.disabled = true;
                        c.readOnly = true;
                    }
                } else {
                    c.disabled = true;
                    c.readOnly = true;
                }
            });
            // æ³¨æ„ï¼šé–å®šé é¢çš„å¤–è§€ (.locked) åœ¨å‘¼å«æ­¤å‡½å¼å¾Œæ–¼å¤–å±¤è‡ªè¡ŒåŠ å…¥ï¼Œ
            // å›  cloneDoc å¯èƒ½æ˜¯è¡¨å–®ç¯€é»ï¼Œå› æ­¤æ­¤å‡½å¼ä¸è™•ç† body çš„æ¨£å¼ã€‚
        }
        const symptoms = [
            { name: 'åˆ·ç‰™æµè¡€', rec: 'C' },
            { name: 'ç™¼ç‡’', rec: 'P.C.éˆ£.éµ' },
            { name: 'é’æ˜¥ç—˜', rec: 'A.B' },
            { name: 'çš®è†šé¬†å¼›', rec: 'P.C.æ°´' },
            { name: 'éª¨è³ªç–é¬†', rec: 'C.éˆ£' },
            { name: 'è„‚è‚ªè‚', rec: 'P.B.C.åµ.ç”˜è‰' },
            { name: 'å£è§’ç‚', rec: 'B' },
            { name: 'åé ­ç—›', rec: 'B.C.éˆ£.åµ' },
            { name: 'è‡‰éæ²¹', rec: 'A.B.åµ' },
            { name: 'çš®è†šéæ•ç™¼ç‚', rec: 'A.B.C.éˆ£' },
            { name: 'æŠ½ç­‹', rec: 'B.éˆ£' },
            { name: 'è‚¥èƒ–', rec: 'P.B.C.åµ.çº–' },
            { name: 'å¸¸æ‰“å—', rec: 'B.éˆ£' },
            { name: 'æ˜“è…¹ç€‰', rec: 'P.B.è’œ.èŒ' },
            { name: 'ç²‰åˆº', rec: 'A' },
            { name: 'é ­çš®å±‘', rec: 'A.B.æ©„æ¬–æ²¹' },
            { name: 'æ°´è…«', rec: 'P.B.éˆ£' },
            { name: 'éœè„ˆæ›²å¼µ', rec: 'P.C.E' },
            { name: 'å£ä¹¾èˆŒç‡¥', rec: 'A.B' },
            { name: 'å£“åŠ›ç†¬å¤œ', rec: 'P.B' },
            { name: 'é»‘æ–‘', rec: 'C.E.åµ' },
            { name: 'è½é«®åˆ†å‰ç¦¿é ­', rec: 'P.B.åµ' },
            { name: 'å°¿è·¯çµçŸ³', rec: 'A.B.C.éˆ£.æ°´' },
            { name: 'è²§è¡€', rec: 'P.B.E.éµ' },
            { name: 'å£è‡­', rec: 'B' },
            { name: 'å¸¸æ„Ÿå†’', rec: 'P.A.C.ç´«éŒèŠ±' },
            { name: 'çš®è†šç²—ç³™', rec: 'A.åµ.æ©„æ¬–æ²¹' },
            { name: 'å¤šå¤¢ç£¨ç‰™', rec: 'B.éˆ£.åµ' },
            { name: 'å°¿é…¸é«˜ï¼ˆç—›é¢¨ï¼‰', rec: 'P.B.C.æ°´' },
            { name: 'æ›´å¹´æœŸ', rec: 'E.éˆ£.ç”˜è‰' },
            { name: 'è„¹æ°£æ¶ˆåŒ–ä¸è‰¯', rec: 'A.B.éˆ£.èŒ.é…µç´ ' },
            { name: 'éæ•æ‰“å™´åš', rec: 'P.A.C.E' },
            { name: 'æ¿•ç–¹', rec: 'B.æ©„æ¬–æ²¹.é­šæ²¹' },
            { name: 'è‚Œè‚‰é—œç¯€é…¸ç—›', rec: 'B.E.éˆ£.æœˆè¦‹.é­š' },
            { name: 'æ”è­·è…ºè‚¥å¤§', rec: 'P.A.é‹æ£•æ«š' },
            { name: 'è†½çµçŸ³', rec: 'A.æ—©é¤.é…µç´ ' },
            { name: 'èƒƒå£ä¸å¥½', rec: 'P.B.æ´»' },
            { name: 'ä¾¿ç§˜', rec: 'B.éˆ£.æ°´.çº–.åµ' },
            { name: 'ç¶“æœŸä¸é †', rec: 'P.æœˆè¦‹' },
            { name: 'æ†‚é¬±æ²®å–ª', rec: 'B.éˆ£.é­š.åµ' },
            { name: 'è†€èƒ±ç„¡åŠ›é »å°¿', rec: 'P.B.E.èŒ' },
            { name: 'æŠ½è¸å–é…’ç¿’æ…£', rec: 'A.B.C.E' },
            { name: 'èƒƒç—›', rec: 'P' },
            { name: 'æ‰‹è…³å†°å†·', rec: 'P.E.åµ.æœˆè¦‹' },
            { name: 'ç¶“ç—›', rec: 'P.B.éˆ£.æœˆè¦‹' },
            { name: 'è¨˜æ†¶åŠ›æ¸›é€€', rec: 'P.éµ.åµ.è‚‰è“¯è“‰' },
            { name: 'è¡€ç³–åé«˜', rec: 'P.éµ.é‹æ£•æ«š' },
            { name: 'è€èŠ±çœ¼ç™½å…§éšœ', rec: 'B.C.E.è‘‰é»ƒç´ ' },
            { name: 'å¸¸åƒè—¥', rec: 'B.C' },
            { name: 'ä¸æ˜“å—å­•', rec: 'P.A.E.æœˆè¦‹.éµ.é‹…' },
            { name: 'å­•å', rec: 'B' },
            { name: 'å¤±çœ ç¡ä¸å¥½', rec: 'B.éˆ£.ç”˜è‰' },
            { name: 'è¡€å£“åé«˜', rec: 'B.éˆ£.Q10.é­š.èŒ¶' },
            { name: 'é£›èšŠç—‡', rec: 'A.C.è‘‰é»ƒç´ ' },
            { name: 'ç–²å€¦', rec: 'P.B' },
            { name: 'ç™½å¸¶', rec: 'A.B.è’œ.èŒ' },
            { name: 'æ‡·å­•å“ºä¹³', rec: 'P.ç¶œåˆ.B.éˆ£.é­š.åµ' },
            { name: 'æ˜“æ€’ä¸è€ç…©', rec: 'B.éˆ£.é­š' },
            { name: 'è¡€è„‚åé«˜', rec: 'B.åµ.èŒ¶.ç´ ' },
            { name: 'ä¸‰Cæ—', rec: 'A.B.è‘‰é»ƒç´ ' }
        ];
        // Category mapping for lifestyle questions
        const categoryMapping = {
            '1': ['A','B','C','D','E','CaMg','FE','çº–ç¶­','è›‹ç™½è³ª','å¾®é‡å…ƒç´ '],
            '2': ['A','B','C','E','çº–ç¶­','å¾®é‡å…ƒç´ '],
            '3': ['B','E','FE','çº–ç¶­','å¾®é‡å…ƒç´ '],
            '4': ['A','B','D','CaMg','è›‹ç™½è³ª'],
            '5': ['CaMg','FE','å¾®é‡å…ƒç´ '],
            '6': ['D','FE','è›‹ç™½è³ª','å¾®é‡å…ƒç´ '],
            '7': ['B','C','E'],
            '8': ['A','C','E','FE'],
            '9': ['A','B','C','D','E','CaMg','FE','çº–ç¶­','è›‹ç™½è³ª','å¾®é‡å…ƒç´ ']
        };
        // Inject symptoms into the questionnaire page as a table with 6 rows
        function injectSymptoms() {
            const symptomList = document.querySelector('#questionnairePage .symptom-list');
            const rowCount = 6;
            const itemsPerRow = Math.ceil(symptoms.length / rowCount);
            const symptomTable = document.createElement('table');
            symptomTable.className = 'symptom-table';
            for (let row = 0; row < rowCount; row++) {
                const tr = document.createElement('tr');
                for (let col = 0; col < itemsPerRow; col++) {
                    const index = row * itemsPerRow + col;
                    const td = document.createElement('td');
                    if (index < symptoms.length) {
                        const item = symptoms[index];
                        const id = 'symptom_' + index;
                        td.innerHTML = `<input type="checkbox" id="${id}" name="symptom" value="${item.name}" data-rec="${item.rec}">` +
                                       `<label for="${id}"> ${item.name} <span style="color: #888; font-size: 12px;">(${item.rec})</span></label>`;
                    }
                    tr.appendChild(td);
                }
                symptomTable.appendChild(tr);
            }
            symptomList.innerHTML = '';
            symptomList.appendChild(symptomTable);
        }
        // Compute lifestyle score
        function computeScore() {
            const categoryChecks = document.querySelectorAll('.category:checked');
            let total = categoryChecks.length * 2;
            document.getElementById('lifestyleResult').textContent = 'ç”Ÿæ´»å‹æ…‹åˆ†æ•¸ï¼š' + total + ' åˆ†';
        }
        window.computeScore = computeScore;
        // Update category checkboxes based on mapping
        function updateCategories(row, isChecked) {
            const categoriesForRow = categoryMapping[String(row)] || Array.from(
                document.querySelectorAll(`input.category[data-row="${row}"]`)
            ).map(catInput => catInput.dataset.cat);
            categoriesForRow.forEach(cat => {
                const catCheckbox = document.querySelector(
                    `input.category[data-row="${row}"][data-cat="${cat}"]`
                );
                if (catCheckbox) {
                    catCheckbox.checked = isChecked;
                }
            });
        }
        // Disable and clone the questionnaire content for saving
        function saveSubmission(form) {
            const nameVal = form.querySelector('input[name="name"]').value.trim();
            if (!nameVal) return;
            // Clone the entire document
            const clone = document.documentElement.cloneNode(true);
            // Remove home and manage pages
            const homeEl = clone.querySelector('#homePage');
            if (homeEl) homeEl.remove();
            const manageEl = clone.querySelector('#managePage');
            if (manageEl) manageEl.remove();
            // Ensure questionnaire page is visible
            const qPage = clone.querySelector('#questionnairePage');
            if (qPage) {
                qPage.style.display = 'block';
            }
            // åŒæ­¥å€¼ä¸¦é–å®šè¤‡è£½é é¢
            const origForm = document.getElementById('questionnaire');
            const cloneForm = clone.querySelector('#questionnaire');
            if (origForm && cloneForm) {
                lockAndPreserve(origForm, cloneForm);
            }

            // Also copy the computed output so that the saved page displays the
            // summary results exactly as shown on the original page.  Without
            // this step the cloned document would contain an empty
            // <div id="formOutput"> if scripts were removed before filling it.
            const origOutput = document.getElementById('formOutput');
            const cloneOutput = clone.querySelector('#formOutput');
            if (origOutput && cloneOutput) {
                cloneOutput.innerHTML = origOutput.innerHTML;
            }
            // ç‚ºè¤‡è£½é é¢çš„ body åŠ ä¸Š .locked æ¨£å¼ä»¥å‘ˆç¾ä¸å¯ç·¨è¼¯
            const lockedBody = clone.querySelector('body');
            if (lockedBody) lockedBody.classList.add('locked');
            // Remove scripts to avoid executing original logic in saved page
            clone.querySelectorAll('script').forEach(scr => scr.remove());
            // Update title with the name value
            const titleEl = clone.querySelector('title');
            if (titleEl) titleEl.textContent = nameVal;
            const savedHtml = '<!DOCTYPE html>' + clone.outerHTML;
            // Save name list
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || [];
            } catch (e) {
                names = [];
            }
            if (!names.includes(nameVal)) {
                names.push(nameVal);
                localStorage.setItem('savedNames', JSON.stringify(names));
            }
            localStorage.setItem('savedPage_' + nameVal, savedHtml);
            // Open saved page in new window
            const newWin = window.open();
            if (newWin) {
                newWin.document.write(savedHtml);
                newWin.document.close();
            }
        }
        // Build the management table listing saved names. Displays up to 4 rows and includes a delete button per row.
        function buildManageTable() {
            const table = document.getElementById('manageTable');
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || [];
            } catch (e) {
                names = [];
            }
            const rowCount = 4;
            table.innerHTML = '';
            for (let i = 0; i < rowCount; i++) {
                const tr = document.createElement('tr');
                const nameTd = document.createElement('td');
                const deleteTd = document.createElement('td');
                if (i < names.length) {
                    const name = names[i];
                    const link = document.createElement('a');
                    link.href = '#';
                    link.textContent = name;
                    link.addEventListener('click', function(ev) {
                        ev.preventDefault();
                        openSavedPage(name);
                    });
                    nameTd.appendChild(link);
                    const delBtn = document.createElement('button');
                    delBtn.textContent = 'åˆªé™¤';
                    delBtn.className = 'delete-btn';
                    delBtn.addEventListener('click', function(ev) {
                        ev.preventDefault();
                        deleteEntry(name);
                    });
                    deleteTd.appendChild(delBtn);
                } else {
                    // empty cells for remaining rows
                    nameTd.innerHTML = '&nbsp;';
                    deleteTd.innerHTML = '&nbsp;';
                }
                tr.appendChild(nameTd);
                tr.appendChild(deleteTd);
                table.appendChild(tr);
            }
        }

        // Delete an entry from the saved list and remove its stored page
        function deleteEntry(name) {
            let names = [];
            try {
                names = JSON.parse(localStorage.getItem('savedNames')) || [];
            } catch (e) {
                names = [];
            }
            const newNames = names.filter(n => n !== name);
            localStorage.setItem('savedNames', JSON.stringify(newNames));
            localStorage.removeItem('savedPage_' + name);
            buildManageTable();
        }
        // Open saved page from localStorage
        function openSavedPage(name) {
            const html = localStorage.getItem('savedPage_' + name);
            if (html) {
                const win = window.open();
                if (win) {
                    win.document.write(html);
                    win.document.close();
                }
            } else {
                alert('ç„¡æ³•æ‰¾åˆ°è©²è³‡æ–™é é¢ã€‚');
            }
        }
        // Attach event listeners after DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Ensure there is at least one fictional entry when the page first loads
            try {
                let initNames = JSON.parse(localStorage.getItem('savedNames')) || [];
                if (!Array.isArray(initNames) || initNames.length === 0) {
                    const defaultName = 'ç‹å¤§æ˜';
                    initNames = [defaultName];
                    localStorage.setItem('savedNames', JSON.stringify(initNames));
                    const dummyPage = '<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><title>' + defaultName + '</title></head><body><h1>' + defaultName + 'çš„å•å·è³‡æ–™</h1><p>é€™æ˜¯ä¸€å€‹è™›æ§‹çš„ç¯„ä¾‹è³‡æ–™ï¼Œç”¨ä¾†å±•ç¤ºè³‡æ–™ç®¡ç†åŠŸèƒ½ã€‚</p></body></html>';
                    localStorage.setItem('savedPage_' + defaultName, dummyPage);
                }
            } catch (err) {
                // On any error, reset dummy data
                const defaultName = 'ç‹å¤§æ˜';
                localStorage.setItem('savedNames', JSON.stringify([defaultName]));
                const dummyPage = '<!DOCTYPE html><html lang="zh-Hant"><head><meta charset="UTF-8"><title>' + defaultName + '</title></head><body><h1>' + defaultName + 'çš„å•å·è³‡æ–™</h1><p>é€™æ˜¯ä¸€å€‹è™›æ§‹çš„ç¯„ä¾‹è³‡æ–™ï¼Œç”¨ä¾†å±•ç¤ºè³‡æ–™ç®¡ç†åŠŸèƒ½ã€‚</p></body></html>';
                localStorage.setItem('savedPage_' + defaultName, dummyPage);
            }
            // Inject symptom list
            injectSymptoms();
            // Bind lifestyle checkbox to update categories
            document.querySelectorAll('.life-checkbox').forEach(chk => {
                chk.addEventListener('change', function() {
                    const row = this.dataset.row;
                    updateCategories(row, this.checked);
                });
            });
            // BMI auto calculation
            (function() {
                const heightInput = document.querySelector('input[name="height"]');
                const weightInput = document.querySelector('input[name="weight"]');
                const bmiInput = document.querySelector('input[name="bmi"]');
                function calculateBMI() {
                    const h = parseFloat(heightInput.value);
                    const w = parseFloat(weightInput.value);
                    if (h > 0 && w > 0) {
                        const heightM = h / 100.0;
                        const bmi = w / (heightM * heightM);
                        bmiInput.value = bmi.toFixed(1);
                    } else {
                        bmiInput.value = '';
                    }
                }
                if (heightInput && weightInput && bmiInput) {
                    heightInput.addEventListener('input', calculateBMI);
                    weightInput.addEventListener('input', calculateBMI);
                }
            })();
            // Water filter info toggle
            (function() {
                const waterSelect = document.getElementById('waterTypeSelect');
                const waterInfo = document.getElementById('waterFilterInfo');
                if (waterSelect && waterInfo) {
                    waterSelect.addEventListener('change', function() {
                        if (this.value === 'å®¶ç”¨æ·¨æ°´å™¨') {
                            waterInfo.style.display = 'block';
                        } else {
                            waterInfo.style.display = 'none';
                        }
                    });
                }
            })();
            // Handle form submission
            document.getElementById('questionnaire').addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                const selectedSymptoms = [];
                document.querySelectorAll('input[name="symptom"]:checked').forEach(chk => {
                    selectedSymptoms.push({ name: chk.value, rec: chk.dataset.rec });
                });
                let lifestyleScore = document.querySelectorAll('.category:checked').length * 2;
                let output = '<h3>å¡«å¯«çµæœ</h3>';
                output += '<p><strong>å§“åï¼š</strong>' + (formData.get('name') || '') + '</p>';
                output += '<p><strong>æ€§åˆ¥ï¼š</strong>' + (formData.get('gender') || '') + '</p>';
                output += '<p><strong>å¹´é½¡ï¼š</strong>' + (formData.get('age') || '') + '</p>';
                output += '<p><strong>ç”Ÿæ´»å‹æ…‹åˆ†æ•¸ï¼š</strong>' + lifestyleScore + ' åˆ†</p>';
                if (selectedSymptoms.length > 0) {
                    output += '<p><strong>å‹¾é¸çš„ç—‡ç‹€èˆ‡å»ºè­°ï¼š</strong></p><ul>';
                    selectedSymptoms.forEach(item => {
                        output += '<li>' + item.name + ' â€” æ¨è–¦ï¼š' + item.rec + '</li>';
                    });
                    output += '</ul>';
                    const nutrientCounts = {};
                    selectedSymptoms.forEach(item => {
                        item.rec.split('.').forEach(nutrient => {
                            const trimmed = nutrient.trim();
                            if (trimmed) {
                                nutrientCounts[trimmed] = (nutrientCounts[trimmed] || 0) + 1;
                            }
                        });
                    });
                    const summaryParts = Object.keys(nutrientCounts).map(key => key + '*' + nutrientCounts[key]);
                    if (summaryParts.length > 0) {
                        const summaryLines = summaryParts.map(part => 'ã€‚' + part).join('<br>');
                        output += '<p><strong>ç¼ºä¹ç‡Ÿé¤Šç´ çµ±è¨ˆï¼š</strong><br>' + summaryLines + '</p>';
                    }
                } else {
                    output += '<p><strong>æœªå‹¾é¸ç—‡ç‹€ã€‚</strong></p>';
                }
                document.getElementById('formOutput').innerHTML = output;
                // Save a copy of the questionnaire as a new page
                saveSubmission(this);
            });
            // Handle navigation buttons
            document.getElementById('btnQuestionnaire').addEventListener('click', function() {
                document.getElementById('homePage').style.display = 'none';
                document.getElementById('managePage').style.display = 'none';
                document.getElementById('questionnairePage').style.display = 'block';
            });
            document.getElementById('btnManage').addEventListener('click', function() {
                document.getElementById('homePage').style.display = 'none';
                document.getElementById('questionnairePage').style.display = 'none';
                document.getElementById('managePage').style.display = 'block';
                buildManageTable();
            });

            // Handle return home button in questionnaire page
            const returnHomeBtn = document.getElementById('btnReturnHome');
            if (returnHomeBtn) {
                returnHomeBtn.addEventListener('click', function() {
                    document.getElementById('homePage').style.display = 'block';
                    document.getElementById('questionnairePage').style.display = 'none';
                    document.getElementById('managePage').style.display = 'none';
                    document.getElementById('formOutput').innerHTML = '';
                    // Optionally reset the form
                    // document.getElementById('questionnaire').reset();
                });
            }

            // Handle return-to-home button in manage page
            const manageReturnBtn = document.getElementById('btnManageReturnHome');
            if (manageReturnBtn) {
                manageReturnBtn.addEventListener('click', function() {
                    // Show the home page and hide others
                    document.getElementById('homePage').style.display = 'block';
                    document.getElementById('questionnairePage').style.display = 'none';
                    document.getElementById('managePage').style.display = 'none';
                });
            }
        });
    </script>
</body>
</html>
